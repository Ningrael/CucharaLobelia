<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>La Cuchara de Lobelia · Inicio</title>
  <meta name="theme-color" content="#2f3b2b" />
  <style>
    :root{
      --lobelia-green: #2E8B57;
      --lobelia-green-dark:#1f5e3b;
      --lobelia-cream: #EFE5CF;
      --lobelia-wood: #3A2A1E;
      --lobelia-gold: #CFA15B;
      --shadow: 0 8px 24px rgba(0,0,0,.28);
      --radius: 16px;
      --radius-pill: 999px;
      --gap: 14px;
    }

    html, body { height: 100%; margin: 0; }
    * { box-sizing: border-box; }

    body {
      background: var(--lobelia-wood);
      min-height: 100dvh;
      display: grid;
      place-items: center;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
    }

    .app {
      width: 100vw; height: 100dvh; max-width: 56.25vh; aspect-ratio: 9 / 16;
      position: relative; overflow: hidden; display: flex; flex-direction: column; align-items: center;
      padding: 18px;
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      background:
        repeating-linear-gradient(45deg, rgba(255,255,255,0.05) 0 2px, transparent 2px 6px),
        linear-gradient(180deg, rgba(239,229,207,0.55), rgba(46,139,87,0.35), rgba(239,229,207,0.55)),
        url('Inicio.png') center/cover no-repeat;
      background-blend-mode: overlay;
    }

    .app::before{
      content: ""; position: absolute; inset: 0; pointer-events:none;
      background: radial-gradient(80% 60% at 50% 50%, rgba(0,0,0,0.00) 0%, rgba(0,0,0,0.25) 60%, rgba(0,0,0,.45) 100%);
    }

    .content{ position: relative; z-index: 1; width: 100%; display: flex; flex-direction: column; align-items: center; gap: var(--gap); margin-top: 160px; }

    .btn{
      appearance:none; border:none; cursor:pointer; user-select:none; letter-spacing:.2px; font-weight:700; text-align:center; 
      transition: transform .06s ease, filter .15s ease, box-shadow .15s ease;
      display: inline-block;
      text-decoration: none;
      color: inherit;
    }
    .btn:active{ transform: translateY(1px) scale(.99); }

    .btn-primary{
      width: 50%; max-width: 200px; padding: 14px 18px; border-radius: var(--radius-pill);
      background: rgba(239,229,207,.92); color: #1c1a16; box-shadow: var(--shadow);
      border: 1px solid rgba(0,0,0,.12);
    }
    @media(hover:hover){ .btn-primary:hover{ filter: brightness(1.03); } }

    .top-right{ position:absolute; top: 12px; right: 12px; z-index:2; display:flex; align-items:center; gap:8px; }
    .btn-google{ padding:10px 12px; border-radius: var(--radius-pill); background: rgba(239,229,207,.95); color:#1c1a16; box-shadow: var(--shadow); border:1px solid rgba(0,0,0,.12); }
    .flag-btn{ width:26px; height:18px; border:none; background-size:cover; background-position:center; border-radius:4px; cursor:pointer; box-shadow: var(--shadow); }

    .bottom{ position: absolute; left: 0; right: 0; z-index:1; display:flex; justify-content:center; }
    .btn-small{ padding: 10px 12px; border-radius: var(--radius-pill); width: 50%; max-width: 200px; background: rgba(239,229,207,.9); color:#1c1a16; box-shadow: var(--shadow); border:1px solid rgba(0,0,0,.12); font-weight:600; }

    .btn-primary, .btn-small, .btn-google{ outline: none; }
    .btn-primary:focus-visible, .btn-small:focus-visible, .btn-google:focus-visible{ box-shadow: 0 0 0 3px rgba(46,139,87,.35), var(--shadow); }
      /* Estado visual deshabilitado (pero clicable para mostrar aviso) */
    .btn-disabled{ opacity:.55; filter:saturate(.2) contrast(.95); }
    @media(hover:hover){ .btn-disabled:hover{ filter:saturate(.25) contrast(.98); }}

    /* Modal WIP */
    .modal-backdrop{ position:fixed; inset:0; background:rgba(0,0,0,.5); display:none; z-index:999; }
    .modal{ position:fixed; inset:auto; left:50%; top:50%; transform:translate(-50%,-50%); background:rgba(239,229,207,.98); color:#1c1a16; border-radius:16px; box-shadow: var(--shadow); border:1px solid rgba(0,0,0,.12); width:min(92vw,420px); padding:18px; display:none; z-index:1000; }
    .modal h2{ margin:0 0 8px; font-size:1.05rem; }
    .modal p{ margin:0 0 14px; line-height:1.35; }
    .modal .actions{ display:flex; justify-content:flex-end; gap:10px; }
    .modal .btn-ok{ padding:10px 14px; border:none; border-radius:999px; background:var(--lobelia-cream); box-shadow: var(--shadow); font-weight:700; cursor:pointer; }
    .modal-open .modal, .modal-open .modal-backdrop{ display:block; }
  </style>
</head>
<body>
  <main class="app" role="main" aria-label="Pantalla de inicio">

    <div class="top-right">
      <button class="flag-btn" id="lang-es" style="background-image:url('https://flagcdn.com/w20/es.png');" aria-label="Español"></button>
      <button class="flag-btn" id="lang-en" style="background-image:url('https://flagcdn.com/w20/gb.png');" aria-label="English"></button>
      <button class="btn btn-google btn-disabled" type="button" data-wip="google" aria-disabled="true" data-i18n="google">Sesión Google</button>
    </div>

    <div class="content" aria-live="polite">
      <a class="btn btn-primary" id="btn-misiones" href="misiones/index.html" target="_self" aria-label="Abrir Misiones Matched Play" data-i18n="missions">
        Misiones Matched play
      </a>

      <button class="btn btn-primary btn-disabled" type="button" data-wip aria-disabled="true" data-i18n="tutorials">Tutoriales</button>
      <button class="btn btn-primary btn-disabled" type="button" data-wip aria-disabled="true" data-i18n="calendars">Calendarios</button>
      <button class="btn btn-primary btn-disabled" type="button" data-wip aria-disabled="true" data-i18n="stl">STL de interés</button>
    </div>

    <div class="bottom" style="bottom: 60px;">
      <button class="btn btn-small btn-disabled" type="button" data-wip aria-disabled="true" data-i18n="settings">Configuración</button>
    </div>

    <div class="bottom" style="bottom: 14px;">
      <button class="btn btn-small btn-disabled" type="button" data-wip aria-disabled="true" data-i18n="contact">Contacta y reporta bugs</button>
    </div>

    <!-- Modal WIP -->
    <div id="wip-backdrop" class="modal-backdrop" aria-hidden="true"></div>
    <div id="wip-modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="wip-title" aria-describedby="wip-desc" aria-hidden="true">
      <h2 id="wip-title">Función en construcción</h2>
      <p id="wip-desc">Estamos trabajando en esta sección. Vuelve en un tiempo.</p>
      <div class="actions">
        <button id="wip-ok" class="btn-ok" type="button">OK</button>
      </div>
    </div>
  </main>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const modal = document.getElementById('wip-modal');
      const backdrop = document.getElementById('wip-backdrop');
      const okBtn = document.getElementById('wip-ok');
      const modalTitle = document.getElementById('wip-title');
      const modalDesc = document.getElementById('wip-desc');

      const translations = {
        es: {
          missions: 'Misiones Matched play',
          tutorials: 'Tutoriales',
          calendars: 'Calendarios',
          stl: 'STL de interés',
          settings: 'Configuración',
          contact: 'Contacta y reporta bugs',
          google: 'Sesión Google',
          modalTitleGeneric: 'Función en construcción',
          modalDescGeneric: 'Estamos trabajando en esta sección. Vuelve en un tiempo.',
          modalTitleGoogle: 'Login con Google',
          modalDescGoogle: 'El inicio de sesión con Google estará disponible pronto.',
          ok: 'OK'
        },
        en: {
          missions: 'Matched Play Missions',
          tutorials: 'Tutorials',
          calendars: 'Calendars',
          stl: 'Interesting STL',
          settings: 'Settings',
          contact: 'Contact & report bugs',
          google: 'Google Sign-in',
          modalTitleGeneric: 'Feature under construction',
          modalDescGeneric: 'We are working on this section. Please check back later.',
          modalTitleGoogle: 'Google Sign-in',
          modalDescGoogle: 'Google login will be available soon.',
          ok: 'OK'
        }
      };

      let currentLang = (localStorage.getItem('lobelia_lang') || (navigator.language || 'es').slice(0,2));
      if (!['es','en'].includes(currentLang)) currentLang = 'es';

      const applyLang = (lang) => {
        document.documentElement.lang = lang;
        document.querySelectorAll('[data-i18n]').forEach(el => {
          const key = el.getAttribute('data-i18n');
          const val = translations[lang] && translations[lang][key];
          if (val) el.textContent = val;
        });
        okBtn.textContent = translations[lang].ok;
      };

      const switchLang = (lang) => {
        currentLang = lang;
        localStorage.setItem('lobelia_lang', lang);
        applyLang(lang);
      };

      // Inicializa idioma al cargar
      applyLang(currentLang);

      // Eventos banderas
      document.getElementById('lang-es').addEventListener('click', () => switchLang('es'));
      document.getElementById('lang-en').addEventListener('click', () => switchLang('en'));

      let lastFocus = null;
      const openModal = (type) => {
        lastFocus = document.activeElement;
        document.documentElement.classList.add('modal-open');
        modal.removeAttribute('aria-hidden');
        backdrop.removeAttribute('aria-hidden');
        if(type === 'google'){
          modalTitle.textContent = translations[currentLang].modalTitleGoogle;
          modalDesc.textContent = translations[currentLang].modalDescGoogle;
        } else {
          modalTitle.textContent = translations[currentLang].modalTitleGeneric;
          modalDesc.textContent = translations[currentLang].modalDescGeneric;
        }
        okBtn.focus();
      };

      const closeModal = () => {
        document.documentElement.classList.remove('modal-open');
        modal.setAttribute('aria-hidden','true');
        backdrop.setAttribute('aria-hidden','true');
        if (lastFocus && typeof lastFocus.focus === 'function') lastFocus.focus();
      };

      okBtn.addEventListener('click', closeModal);
      backdrop.addEventListener('click', closeModal);
      document.addEventListener('keydown', (e) => { if (e.key === 'Escape') closeModal(); });

      document.querySelectorAll('[data-wip]').forEach(btn => {
        btn.addEventListener('click', (e) => {
          e.preventDefault();
          const type = btn.getAttribute('data-wip');
          openModal(type);
        }, { passive: true });
      });
    });
  </script>
</body>
</html>
